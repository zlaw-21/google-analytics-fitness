# Google Data Analytics Capstone

### Table of Contents

- [Introduction](#introduction)
- [Business Request (ASK)](#business-request-ask)
- [Data Sets (PREPARE)](#data-sets-prepare)
- [Data Cleaning (PROCESS)](#data-cleaning-process)
- [Data Analysis (ANALYZE)](data-analysis-analyze)
- [Summary and Key Findings (SHARE)](#summary-and-key-findings-share)
- [Recommendations (ACT)](#recommendations-act)


### Introduction

As part of the Google Data Analytics Certification, an optional case study is given to participants to complete to showcase the skills which they had obtained throughout the learning process.

For my case study, I chose to complete ***Case Study 2: How Can a Wellness Technology
Company Play It Smart?*** offered in Module 8 of the certification track.

The primary objective of this case study is to develop a high level marketing strategy for a specific Bellabeat product based upon user-level fitness data captured on a competitor's smart device.

You can view the full case study PDF [here](/Case_Study_2_Bellabeat.pdf) provided by Google for an in depth view on the project details and scenario.


### Business Request (ASK)

Per request from the Chief Creative Officer at Bellabeat, I was tasked with analyzing public competitor data to answer the following questions:

- What are some trends in smart device usage?
- How could these trends apply to Bellabeat customers?
- How could these trends help influence Bellabeat marketing strategy?

Further, how can we apply these insights to a marketing strategy for a specific Bellabeat product?


### Data Sets (PREPARE)

The datasets used were sourced from Möbius on Kaggle [here](https://www.kaggle.com/datasets/arashnic/fitbit/data). The datasets are fully open source as given by the original [CC0: Public Domain](https://creativecommons.org/publicdomain/zero/1.0/) license.

The data description provided directly from Möbius is as follows:

>*This dataset generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016. Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring. Individual reports can be parsed by export session ID (column A) or timestamp (column B). Variation between output represents use of different types of Fitbit trackers and individual tracking behaviors / preferences.*

The original directory provides access to 29 CSV files containing data from 03.12.2016-05.12.2016 at different levels of granularity. For this analysis I chose to analyze 12 of the datasets provided at minute level granularity, focused on features offered in the Bellabeat product line (Heart Rate, Calorie, Intensity, METs, Sleep, and Steps).

Minute level granularity was chosen as it allows for easy conversions and binning between timeframes and creates consistency between all data captured by each feature. All datasets and file locations from the original directory are as follows:

- Fitabase Data 3.12.16-4.11.16/heartrate_seconds_merged.csv
- Fitabase Data 4.12.16-5.12.16/heartrate_seconds_merged.csv
- Fitabase Data 3.12.16-4.11.16/minuteCaloriesNarrow_merged.csv
- Fitabase Data 4.12.16-5.12.16/minuteCaloriesNarrow_merged.csv
- Fitabase Data 3.12.16-4.11.16/minuteIntensitiesNarrow_merged.csv
- Fitabase Data 4.12.16-5.12.16/minuteIntensitiesNarrow_merged.csv
- Fitabase Data 3.12.16-4.11.16/minuteMETsNarrow_merged.csv
- Fitabase Data 4.12.16-5.12.16/minuteMETsNarrow_merged.csv
- Fitabase Data 3.12.16-4.11.16/minuteSleep_merged.csv
- Fitabase Data 4.12.16-5.12.16/minuteSleep_merged.csv
- Fitabase Data 3.12.16-4.11.16/minuteStepsNarrow_merged.csv
- Fitabase Data 4.12.16-5.12.16/minuteStepsNarrow_merged.csv

For the purposes of the case study, data used in this study is considered to be current and accurate, for a breakdown of the true data integrity, please see the [Limitations](#limitations) section below.


### Data Cleaning (PROCESS)

Throughout the entire project, R was used exclusively to clean and visualize the data. For the cleaning process in Step 1, the same steps were applied to each dataset with slight variations in syntax based upon variations in each respective set.

The high level process used is as follows:

**Step One: Clean and Join Each matching set together for each feature**

*Load each group of datasets into an R dataframe*

```r
# 3.12.16 - 4.11.16
minutes_calorie_early <- 
  read_csv("C:/xxx/mturkfitbit_export_3.12.16-4.11.16/Fitabase Data 3.12.16-4.11.16/minuteCaloriesNarrow_merged.csv")

# 4.12.16 - 5.12.16
minutes_calorie_late <-
  read_csv("C:/xxx/mturkfitbit_export_4.12.16-5.12.16/Fitabase Data 4.12.16-5.12.16/minuteCaloriesNarrow_merged.csv")
```

*Adjust date/time to the correct format*

```r
minutes_calorie_early <- minutes_calorie_early %>% 
  mutate(ActivityMinute = mdy_hm(sub(":00 ", " ", ActivityMinute))) %>% 
  rename(date_time = ActivityMinute)

minutes_calorie_late <- minutes_calorie_late %>% 
  mutate(ActivityMinute = mdy_hm(sub(":00 ", " ", ActivityMinute))) %>% 
  rename(date_time = ActivityMinute)
```

*Determine if either set has duplicate values based upon ID and date_time, then check for overlapping data between sets*

```r
minutes_calorie_early %>% 
  count(Id, date_time) %>% 
  filter(n > 1)

minutes_calorie_late %>% 
  count(Id, date_time) %>% 
  filter(n > 1)

minutes_calorie_early %>% 
  arrange(desc(date_time)) %>% 
  head()

minutes_calorie_late %>% 
  arrange(date_time) %>% 
  head()
```

*Remove the overlapping data between sets to ensure data integrity*

```r
minutes_calorie_early <- minutes_calorie_early %>%
  filter(date_time < as.Date(max(date_time)))

max(minutes_calorie_early$date_time)
```

*Join the early and late sets together, arrange by ID, convert column names to camel case, and convert ID to factor*

```r
minutes_calorie <-
  rbind(minutes_calorie_early, minutes_calorie_late) %>% 
  arrange(Id) %>% 
  clean_names() %>% 
  mutate(id = as.factor(id))

glimpse(minutes_calorie)
```

**Step Two: Join all Dataframes Together for Comparison between features**

*List all dataframe names for the for join function*

```r
df_list <- list(minutes_calorie,
                minutes_mets, 
                minutes_heartrate, 
                minutes_intensities, 
                minutes_sleep, 
                minutes_steps)
```

*Create the function to join each dataframe together based upon the input list and join keys*

```r
join_sets <- function(dfs, keys) {
  
  data <- dfs[[1]]
  for (i in 2:length(dfs)) {
    data <- full_join(data, dfs[[i]], by = keys)
    }
  return(data)
  
}
```

*Join all datasets on id and date_time, then filter out the earliest and latest dates to normalize day-level distribution and reduce edge bias*

```r
minutes_data <- 
  join_sets(df_list, c("id", "date_time")) %>% 
  filter(date_time > as.Date("2016-03-12") &
           date_time < as.Date("2016-05-12"))

glimpse(minutes_data)
```


### Data Analysis (ANALYZE)

The analysis conducted was targeted to uncover how users were actually utilizing their device, and to identify high level trends in their behavior to formulate a marketing strategy for one of the products in Bellabeat's product line.

**Total Fitbit Inactivity by Weekday and Time**

To identify outage periods throughout a typical week, I created a heatmap to visualize all missing values from the minutes_data dataframe by weekday and time in 30 minute bins.

NOTE: Additional data manipulation steps were taken to join the minutes_data dataset with NA values to create the outage_data dataframe. See [visualizations.r](/visualizations.R) for more detail.

```r
outage_data %>% 
  filter(week_start < max(week_start),
         if_all(3:9, is.na)) %>%
  ggplot(aes(x = weekday, y = true_min)) +
  geom_bin2d(bins = c(7, 48),
             color = "white") +
  scale_y_continuous(
    breaks = breaks,
    labels = time_labels) +
  ggtitle("Total Fitbit Inactivity by Weekday and Time") +
  xlab("Weekday") +
  ylab("Time of Day") +
  scale_fill_gradient(low = "gray90", 
                       high = "red") +
  theme_minimal()
```

![Total Fitbit Inactivity by Weekday and Time](/Images/Total%20Fitbit%20Inactivity%20by%20Weekday%20and%20Time.png)

*Peak outage periods are between Saturday and Monday, with Monday showing the highest level of inactivity*

*Users are most active on their devices between Tuesday-Thursday*

**Total Feature Usage in Hours**

To identify the most used features, I created a bar graph to visualize active instances for all features throughout the life cycle of the study.

```r
minutes_data %>% 
  select(-id, -date_time, -log_id) %>% 
  summarize(across(everything(), ~ sum(. > 0, na.rm = TRUE))) %>%
  pivot_longer(cols = everything(), names_to = "feature", values_to = "count") %>% 
  mutate(count = count / 60,
         feature = fct_reorder(feature, count, .desc = TRUE)) %>% 
  ggplot(aes(x = feature, y = count, fill = feature)) +
  geom_bar(stat = "identity") +
  scale_y_continuous(labels = scales::label_comma(),
                     breaks = scales::breaks_extended(n = 10)) +
  scale_fill_viridis_d() +
  ggtitle("Total Feature Usage in Hours",
          subtitle = "From 3-12-2016 to 5-11-2016") +
  xlab("Feature") +
  ylab("Total Hours") +
  theme_minimal() +
  theme(legend.position = "none")
```

![Total Feature Usage in Hours](Images/Total%20Feature%20Usage%20in%20Hours.png)

*METs and Calorie features are used over 4x more than the third most used feature.*
*NOTE: METs is used to calculate Calories, so they share an "always on" relationship.*

**Total Feature Usage in Hours (minus METs)**

After finding the significant disparity between Calories, METs and the rest of the features, I recreated the same bar graph to compare the difference between heart rate, intensity, steps, and sleep.

```r
minutes_data %>% 
  select(-id, -date_time, -log_id, -calories, -mets) %>% 
  summarize(across(everything(), ~ sum(. > 0, na.rm = TRUE))) %>%
  pivot_longer(cols = everything(), names_to = "feature", values_to = "count") %>% 
  mutate(count = count / 60,
         feature = fct_reorder(feature, count, .desc = TRUE)) %>% 
  ggplot(aes(x = feature, y = count, fill = feature)) +
  geom_bar(stat = "identity") +
  scale_y_continuous(labels = scales::label_comma(),
                     breaks = scales::breaks_extended(n = 10)) +
  scale_fill_viridis_d() +
  ggtitle("Total Feature Usage in Hours",
          subtitle = "From 3-12-2016 to 5-11-2016") +
  xlab("Feature") +
  ylab("Total Hours") +
  theme_minimal() +
  theme(legend.position = "none")
```

![Total Feature Usage in Hours](Images/Total%20Feature%20Usage%20in%20%20Hours%20(minus%20METs).png)

*From closer inspection, heart rate has about 800 more use hours than intensity, while the gap between intensity and sleep is around 600–700 hours, potentially indicating significantly higher engagement with the heart rate feature compared to intensity, steps, and sleep.*

**Daily Feature Usage**

To determine the consistency of feature usage over the study period, I created a line graph to visualize daily usage between 3-12-2016 and 5-11-2016.

```r
minutes_data %>%
  mutate(day_group = floor_date(date_time, unit = "day")) %>%
  select(-id, -date_time, -log_id) %>% 
  group_by(day_group) %>% 
  summarize(across(everything(), ~ sum(. > 0, na.rm = TRUE) / 60)) %>% 
  pivot_longer(!day_group, names_to = "feature", values_to = "count") %>% 
  ggplot(aes(x = day_group, y = count, color = feature)) +
  geom_line(linewidth = 1.2) +
  scale_x_datetime(date_breaks = "1 week") +
  labs(title = "Daily Feature Usage",
       subtitle = "From 3-12-2016 to 5-11-2016",
       x = "Date",
       y = "Total Hours",
       color = "Feature") +
  theme_minimal() +
  theme(legend.text = element_text(size = 10),
        legend.title = element_text(size = 12))
```

![Daily Feature Usage](Images/Daily%20Feature%20Usage.png)

*From the consistency analysis, we can see that calorie and METs maintain a steady and considerable lead over the rest of the features throughout the study period. NOTE: METs and calorie lines are overlapping.*

*Heart rate data is missing from the start of the period through the end of March, with values beginning to appear in early April. This is likely due to a tracking error, furthering the inference that heart rate is considerably more popular than the intensity, steps, and sleep features.*

**Total Intensity by Weekday and Time**

Now that we found that Tuesday, Wednesday, and Thursday are the most active days for users and calorie, METs, and heart rate are the most used features, I created a sequence of heatmaps to identify the optimal time for our marketing strategy.

I started by creating a heat map of total intensity throughout each week of the study period.

NOTE: Additional data manipulation steps were taken to create the heat_minutes dataframe from minutes_data. See [visualizations.r](/visualizations.R) for more detail.

```r
heat_minutes %>%
  mutate(min = floor(true_min / 30)) %>%
  filter(week_start < max(week_start),
          !is.na(intensity)) %>% 
  group_by(min, weekday) %>% 
  summarize(intensity = sum(intensity)) %>%
  ggplot(aes(x = weekday, y = min, fill = intensity)) +
  geom_tile(color = "white") +
  scale_y_continuous(breaks = c(seq(0, 44, by = 4), 47),
                     labels = time_labels) +
  scale_fill_gradient(low = "gray90", 
                      high = "red") +
  labs(title = "Total Intensity by Weekday and Time",
       subtitle = "30 min intervals, From 3-12-2016 to 5-11-2016",
       x = "Weekday",
       y = "Time",
       fill = "Total Intensity") +
  geom_hline(yintercept = 39, color = "black", linetype = "dashed", size = 1.06) +
  annotate("text",
           x = 4,
           y = 39,
           label = "End of peak activity at 7:30 PM",
           vjust = -1.09,
           size = 4,
           color = "black",
           fontface = "bold.italic") +
  theme_minimal()
```

![Total Intensity by Weekday and Time](Images/Total%20Intensity%20by%20Weekday%20and%20Time.png)

*From our intensity visualization, we can determine that user's peak physical activity ends around 7:30 PM throughout the week, with the starkest contrast on Wednesday.*

**Total METs by Weekday and Time**

To validate the pattern we see in Intensity, I created the same heatmap to visualize METs.

```r
heat_minutes %>%
  mutate(min = floor(true_min / 30)) %>%
  filter(week_start < max(week_start),
         !is.na(mets)) %>% 
  group_by(min, weekday) %>% 
  summarize(mets = sum(mets)) %>%
  ggplot(aes(x = weekday, y = min, fill = mets)) +
  geom_tile(color = "white") +
  scale_y_continuous(breaks = c(seq(0, 44, by = 4), 47),
                     labels = time_labels) +
  scale_fill_gradient(low = "gray90", 
                      high = "red") +
  labs(title = "Total METs by Weekday and Time",
       subtitle = "30 min intervals, From 3-12-2016 to 5-11-2016",
       x = "Weekday",
       y = "Time",
       fill = "Total METs") +
  geom_hline(yintercept = 39, color = "black", linetype = "dashed", size = 1.06) +
  annotate("text",
           x = 4,
           y = 39,
           label = "End of peak activity at 7:30 PM",
           vjust = -1.09,
           size = 4,
           color = "black",
           fontface = "bold.italic") +
  theme_minimal()
```

![Total METs by Weekday and Time](Images/Total%20METs%20by%20Weekday%20and%20Time.png)

*After visualizing METs, we can validate that peak physical activity ends around 7:30 PM throughout the week. While METs and intensity are similar metrics (METs are partially used to calculate intensity), we know the features do not hold a 1:1 relationship from our previous analysis, showcasing a real trend in user behavior throughout the average week.*

**Total Heart Rate by Weekday and Time**

To finalize our marketing strategy, I created an additional heatmap to visualize heart rate throughout the average week. Heart rate was selected as it is far more sensitive to light physical activity than METs or intensity, and will highlight when users have moved into sedentary positions for the remainder of the day.

```r
heat_minutes %>%
  mutate(min = floor(true_min / 30)) %>%
  filter(week_start < max(week_start),
         !is.na(heart_rate)) %>% 
  group_by(min, weekday) %>% 
  summarize(heart_rate = sum(heart_rate)) %>%
  ggplot(aes(x = weekday, y = min, fill = heart_rate)) +
  geom_tile(color = "white") +
  scale_y_continuous(breaks = c(seq(0, 44, by = 4), 47),
                     labels = time_labels) +
  scale_fill_gradient(low = "gray90", 
                      high = "red") +
  labs(title = "Total Heart Rate by Weekday and Time",
       subtitle = "30 min intervals, From 3-12-2016 to 5-11-2016",
       x = "Weekday",
       y = "Time",
       fill = "Total Heart Rate") +
  geom_hline(yintercept = 42, color = "black", linetype = "dashed", size = 1.06) +
  annotate("text",
           x = 4,
           y = 42,
           label = "End of peak activity at 9:00 PM",
           vjust = -1.09,
           size = 4,
           color = "black",
           fontface = "bold.italic") +
  theme_minimal()
```

![Total Heart Rate by Weekday and Time](Images/Total%20Heart%20Rate%20by%20Weekday%20and%20Time.png)

*From our heart rate visualization, we can see that elevated heart rate subsides around 9:00 PM throughout the week.*

*At the end of this window (7:30-9:00 PM), users have completed their peak physical activity for the day and have moved into a rest period.*


### Summary and Key Findings (SHARE)

To return to the original objective, here we will answer each of the three questions asked by the Bellabeat marketing team.

**What are some trends in smart device usage?**

- Users are the least active on their smart watch devices between Saturday-Monday, while being most active between Tuesday-Thursday.
- The most used smart device features are calorie, METs, and heart rate, while the least used are intensity, steps, and sleep. Additionally, feature usage is consistent across time, showcasing that popularity is typically inelastic.
- Lastly, users peak physical activity ends around 7:30 PM throughout the average week and move into rest at round 9:00 PM consistently, especially between Tuesday-Thursday.

**How could these trends apply to Bellabeat customers?**

The trends observed in the Fitbit dataset can be directly applied to Bellabeat customers interested in the Time product line:

>**Time:** This wellness watch combines the timeless look of a classic timepiece with smart technology to track user activity, sleep, and stress. The Time watch connects to the Bellabeat app to provide you with insights into your daily wellness.

The Fitbit dataset originated from smartwatch data with functionality and design most similar to the Time products. Our insights are representative of smartwatch users, and highlight user activity directly in our target market.

**How could these trends help influence Bellabeat marketing strategy?**

The trends we have identified can guide both the sentiment and timing of our marketing strategy for the Time product line. Our analysis has identified the most commonly used features for smartwatch users, their daily activity schedules, and their usage consistency across three months. 

From this depth of user insight, we can tailor a digital marketing strategy to optimize CTR and digital sales by prioritizing METs, calorie, and heart rate feature sentiment, while targeting the end of peak activity periods between Tuesday-Thursday when users have both increased activation energy and a health-conscious mindset.


### Recommendations (ACT)

I recommend to create an A/B testing marketing campaign aimed at increasing digital sales by 5% over three months to ensure the efficacy of the strategy identified from the Fitbit data.

**The control group should:**

- Maintain the current digital marketing strategy for the Time product line.
- Track both CTR and digital sales for comparison with the experimental group for three months.

**The experimental group should:**

- Digitally market advertisements for the Time product line, focusing on the METs, calorie, and heart rate features.
- Exclusively push advertisements between 7:30-9:00 PM on Tuesday, Wednesday, and Thursday for three months.

**To validate success:**

- After three months, digital product sales from the experimental group should see at minimum a 5% increase in total product sales as compared to the control group.
